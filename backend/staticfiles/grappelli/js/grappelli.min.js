var grp={jQuery:jQuery.noConflict(!0)},django={jQuery:grp.jQuery},jQuery=grp.jQuery,inputTypes=["[type='search']","[type='email']","[type='url']","[type='tel']","[type='number']","[type='range']","[type='date']","[type='month']","[type='week']","[type='time']","[type='datetime']","[type='datetime-local']","[type='color']"].join(",");!function(e){grappelli.getFormat=function(e){if("date"==e)return DATE_FORMAT.toLowerCase().replace(/%\w/g,function(e){return(e=e.replace(/%/,""))+e})},grappelli.cleanInputTypes=function(){e("form").each(function(){e(this).find(":input").filter(inputTypes).each(function(){e(this).attr("type","text")})})},grappelli.initDateAndTimePicker=function(){e("p.datetime").each(function(){var t=e(this).html();t=(t=t.replace(/\w*: /,"")).replace(/<br>[^<]*: /g,"<br>"),e(this).html(t)});var t={constrainInput:!1,showOn:"button",buttonImageOnly:!1,buttonText:"",dateFormat:grappelli.getFormat("date"),showButtonPanel:!0,showAnim:"",beforeShow:function(e,t,r){grappelli.datepicker_instance=this}},r=e("input[class*='vDateField']:not([id*='__prefix__'])");r.datepicker(t),"undefined"!=typeof IS_POPUP&&IS_POPUP&&r.datepicker("disable"),e(document).on("click",".ui-datepicker-current",function(){e.datepicker._selectDate(grappelli.datepicker_instance),grappelli.datepicker_instance=null}),e("input[class*='vTimeField']:not([id*='__prefix__'])").grp_timepicker()},grappelli.initFilter=function(t){if(e("a.grp-pulldown-handler").on("click",function(){var t=e(this).closest(".grp-pulldown-container");e(t).toggleClass("grp-pulldown-state-open").children(".grp-pulldown-content").toggle()}),e("a.grp-pulldown-handler").on("mouseout",function(){e(this).blur()}),t||e(".grp-filter-choice").change(function(){location.href=e(this).val()}),"confirm"===t){var r=[];e(".grp-filter-choice").change(function(){var t=e(this).closest(".grp-row").find("label").text(),a="?"!==e(this).val()&&e(this).val().replace("?",""),n=r.findIndex(e=>e.label===t);-1===n?r.push({label:t,value:a}):a?(r.splice(n,1),r.push({label:t,value:a})):r.splice(n,1);var l=r.map(e=>e.value).join("&");e(this).closest(".grp-filter").find("#grp-filter-apply").attr("href","?"+l)})}},grappelli.initSearchbar=function(){e("input.grp-search-field").trigger("focus")},grappelli.updateSelectFilter=function(e){"undefined"!=typeof SelectFilter&&(e.find(".selectfilter").each(function(e,t){var r=t.name.split("-");SelectFilter.init(t.id,r[r.length-1],!1,"{% admin_media_prefix %}")}),e.find(".selectfilterstacked").each(function(e,t){var r=t.name.split("-");SelectFilter.init(t.id,r[r.length-1],!0,"{% admin_media_prefix %}")}))},grappelli.reinitDateTimeFields=function(e){e.find(".vDateField").datepicker({constrainInput:!1,showOn:"button",buttonImageOnly:!1,buttonText:"",dateFormat:grappelli.getFormat("date")}),e.find(".vTimeField").grp_timepicker()},grappelli.get_app_label=function(e){var t=e.next("a");if(t.length>0){var r=t.attr("href").split("?")[0].split("/");return r[r.length-3]}return!1},grappelli.get_model_name=function(e){var t=e.next("a");if(t.length>0){var r=t.attr("href").split("?")[0].split("/");return r[r.length-2]}return!1},grappelli.get_query_string=function(e){var t=e.next("a");if(t.length>0){var r=t.attr("href").split("/");return pairs=r[r.length-1].replace("?","").split("&"),pairs.join(":")}return!1},grappelli.get_to_field=function(e){var t=e.next("a");if(t.length>0&&-1!==t.attr("href").indexOf("_to_field"))for(var r=t.attr("href").split("/"),a=r[r.length-1].replace("?","").split("&"),n=0;n<a.length;n++)if(v=a[n].split("="),"_to_field"==v[0])return v[1];return!1}}(grp.jQuery),function(e){var t={init:function(t){return t=e.extend({},e.fn.grp_autocomplete_fk.defaults,t),this.each(function(){var i=e(this);i.attr({tabindex:"-1",readonly:"readonly"}).addClass("grp-autocomplete-hidden-field"),i.next().next()&&"errorlist"!=i.next().next().attr("class")&&"grp-help"!=i.next().next().attr("class")&&i.next().next().remove(),i.next().after(r).after(a(i.attr("id"))),i.parent().wrapInner("<div class='grp-autocomplete-wrapper-fk'></div>"),i.parent().prepend("<input id='"+i.attr("id")+"-autocomplete' type='text' class='vTextField' value='' />"),t=e.extend({wrapper_autocomplete:i.parent(),input_field:i.prev(),remove_link:i.next().next().hide(),loader:i.next().next().next().hide()},e.fn.grp_autocomplete_fk.defaults,t),l(i,t),n(i,t),i.on("change focus keyup",function(){l(i,t)}),e("label[for='"+i.attr("id")+"']").each(function(){e(this).attr("for",i.attr("id")+"-autocomplete")})})}};e.fn.grp_autocomplete_fk=function(r){return t[r]?t[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?(e.error("Method "+r+" does not exist on jQuery.grp_autocomplete_fk"),!1):t.init.apply(this,arguments)};var r=function(){return e('<div class="grp-loader">loader</div>')},a=function(t){var r=e('<a class="grp-related-remove"></a>');return r.attr("id","remove_"+t),r.attr("href","javascript://"),r.attr("onClick","return removeRelatedObject(this);"),r.hover(function(){e(this).parent().toggleClass("grp-autocomplete-preremove")}),r},n=function(t,r){r.wrapper_autocomplete.find("input:first").on("focus",function(){r.wrapper_autocomplete.addClass("grp-state-focus")}).on("blur",function(){r.wrapper_autocomplete.removeClass("grp-state-focus")}).autocomplete({minLength:1,autoFocus:!0,delay:1e3,source:function(a,n){e.ajax({url:r.autocomplete_lookup_url,dataType:"json",data:"term="+encodeURIComponent(a.term)+"&app_label="+grappelli.get_app_label(t)+"&model_name="+grappelli.get_model_name(t)+"&query_string="+grappelli.get_query_string(t)+"&to_field="+grappelli.get_to_field(t),beforeSend:function(e){r.loader.show()},success:function(t){n(e.map(t,function(e){return{label:e.label,value:e.value}}))},complete:function(e,t){r.loader.hide()}})},focus:function(){return!1},select:function(a,n){return r.input_field.val(n.item.label),t.val(n.item.value),t.trigger("change"),t.val()?e(r.remove_link).show():e(r.remove_link).hide(),!1}}).data("ui-autocomplete")._renderItem=function(t,r){return r.value?e("<li></li>").data("item.autocomplete",r).append(e("<a></a>").text(r.label)).appendTo(t):e("<li class='ui-state-disabled'></li>").data("item.autocomplete",r).append(e("<span class='error'></span>").text(r.label)).appendTo(t)}},l=function(t,r){e.getJSON(r.lookup_url,{object_id:t.val(),app_label:grappelli.get_app_label(t),model_name:grappelli.get_model_name(t),query_string:grappelli.get_query_string(t),to_field:grappelli.get_to_field(t)},function(a){e.each(a,function(n){r.input_field.val(a[n].label),t.val()?e(r.remove_link).show():e(r.remove_link).hide()})})};e.fn.grp_autocomplete_fk.defaults={autocomplete_lookup_url:"",lookup_url:""}}(grp.jQuery),function(e){var t={init:function(t){return t=e.extend({},e.fn.grp_autocomplete_generic.defaults,t),this.each(function(){var p=e(this);p.attr({tabindex:"-1",readonly:"readonly"}).addClass("grp-autocomplete-hidden-field");var s=e(t.content_type).val()||e(t.content_type).find(":checked").val();s&&p.after(r).after(a(p.attr("id"))).after(n(p.attr("id"),s)),p.parent().wrapInner("<div class='grp-autocomplete-wrapper-fk'></div>"),p.parent().prepend("<input id='"+p.attr("id")+"-autocomplete' type='text' class='vTextField' value='' />"),t=e.extend({wrapper_autocomplete:e(this).parent(),input_field:e(this).prev(),remove_link:p.nextAll("a.grp-related-remove").hide(),loader:p.nextAll("div.grp-loader").hide()},e.fn.grp_autocomplete_generic.defaults,t),s&&o(p,t),i(p,t),p.on("change focus keyup",function(){o(p,t)}),e(t.content_type).on("change",function(){l(e(this),t)}),e("label[for='"+p.attr("id")+"']").each(function(){e(this).attr("for",p.attr("id")+"-autocomplete")})})}};e.fn.grp_autocomplete_generic=function(r){return t[r]?t[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?(e.error("Method "+r+" does not exist on jQuery.grp_autocomplete_generic"),!1):t.init.apply(this,arguments)};var r=function(){return e('<div class="grp-loader">loader</div>')},a=function(t){var r=e('<a class="grp-related-remove"></a>');return r.attr("id","remove_"+t),r.attr("href","javascript://"),r.attr("onClick","return removeRelatedObject(this);"),r.hover(function(){e(this).parent().toggleClass("grp-autocomplete-preremove")}),r},n=function(t,r){var a=e('<a class="related-lookup"></a>');return a.attr("id","lookup_"+t),a.attr("href",window.ADMIN_URL+MODEL_URL_ARRAY[r].app+"/"+MODEL_URL_ARRAY[r].model+"/?"),a.attr("onClick","return showRelatedObjectLookupPopup(this);"),a},l=function(t,l){var i=e(l.object_id);i.val(""),i.prev().val(""),i.nextAll("a.related-lookup").remove(),i.nextAll("a.grp-related-remove").remove(),i.nextAll("div.grp-loader").remove();var o=e(t).val()||e(t).find(":checked").val();o&&(i.after(r).after(a(i.attr("id"))).after(n(i.attr("id"),o)),l.remove_link=i.nextAll("a.grp-related-remove").hide(),l.loader=i.nextAll("div.grp-loader").hide())},i=function(t,r){r.wrapper_autocomplete.find("input:first").on("focus",function(){r.wrapper_autocomplete.addClass("grp-state-focus")}).on("blur",function(){r.wrapper_autocomplete.removeClass("grp-state-focus")}).autocomplete({minLength:1,autoFocus:!0,delay:1e3,source:function(a,n){e.ajax({url:r.autocomplete_lookup_url,dataType:"json",data:"term="+encodeURIComponent(a.term)+"&app_label="+grappelli.get_app_label(t)+"&model_name="+grappelli.get_model_name(t)+"&query_string="+grappelli.get_query_string(t),beforeSend:function(t){if(!(e(r.content_type).val()||e(r.content_type).find(":checked").val()))return!1;r.loader.show()},success:function(t){n(e.map(t,function(e){return{label:e.label,value:e.value}}))},complete:function(e,t){r.loader.hide()}})},focus:function(){return!1},select:function(a,n){return r.input_field.val(n.item.label),t.val(n.item.value),t.trigger("change"),t.val()?e(r.remove_link).show():e(r.remove_link).hide(),!1}}).data("ui-autocomplete")._renderItem=function(t,r){return r.value?e("<li></li>").data("item.autocomplete",r).append(e("<a></a>").text(r.label)).appendTo(t):e("<li class='ui-state-disabled'></li>").data("item.autocomplete",r).append(e("<span class='error'></span>").text(r.label)).appendTo(t)}},o=function(t,r){e.getJSON(r.lookup_url,{object_id:t.val(),app_label:grappelli.get_app_label(t),model_name:grappelli.get_model_name(t)},function(a){e.each(a,function(n){r.input_field.val(a[n].label),t.val()?e(r.remove_link).show():e(r.remove_link).hide()})})};e.fn.grp_autocomplete_generic.defaults={autocomplete_lookup_url:"",lookup_url:"",content_type:"",object_id:""}}(grp.jQuery),function(e){var t={init:function(t){return t=e.extend({},e.fn.grp_autocomplete_m2m.defaults,t),this.each(function(){var n=e(this);n.attr({tabindex:"-1",readonly:"readonly"}).addClass("grp-autocomplete-hidden-field"),n.next().after(r).after(a(n.attr("id"))),n.parent().wrapInner("<div class='grp-autocomplete-wrapper-m2m'></div>"),n.parent().prepend("<ul class='grp-repr'><li class='grp-search'><input id='"+n.attr("id")+"-autocomplete' type='text' class='vTextField' value='' /></li></ul>"),t=e.extend({wrapper_autocomplete:n.parent(),wrapper_repr:n.parent().find("ul.grp-repr"),wrapper_search:n.parent().find("li.grp-search"),remove_link:n.next().next().hide(),loader:n.next().next().next().hide()},e.fn.grp_autocomplete_m2m.defaults,t),n.parent().find("ul.errorlist")&&n.parent().find("ul.errorlist").detach().appendTo(n.parent().parent()),n.parent().find("p.grp-help")&&n.parent().find("p.grp-help").detach().appendTo(n.parent().parent()),i(n,t),l(n,t),n.on("change focus keyup",function(){i(n,t)}),e("label[for='"+n.attr("id")+"']").each(function(){e(this).attr("for",n.attr("id")+"-autocomplete")}),t.wrapper_autocomplete.on("click",function(r){e(r.target).hasClass("related-lookup")||e(r.target).hasClass("grp-related-remove")||t.wrapper_search.find("input:first").trigger("focus")})})}};e.fn.grp_autocomplete_m2m=function(r){return t[r]?t[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?(e.error("Method "+r+" does not exist on jQuery.grp_autocomplete_m2m"),!1):t.init.apply(this,arguments)};var r=function(){return e('<div class="grp-loader">loader</div>')},a=function(t){var r=e('<a class="grp-related-remove"></a>');return r.attr("id","remove_"+t),r.attr("href","javascript://"),r.attr("onClick","return removeRelatedObject(this);"),r.hover(function(){e(this).parent().toggleClass("grp-autocomplete-preremove")}),r},n=function(t,r,a){var n=e('<li class="grp-repr"></li>'),l=e('<a class="grp-m2m-remove" href="javascript://"></a>').text(r);n.append(l),n.insertBefore(a.wrapper_search),l.on("click",function(r){var n=e(this).parent().parent().children("li").index(e(this).parent());!function(e,t,r){var a=[];e.val()&&(a=e.val().split(",")),a.splice(t,1),e.val(a.join(",")),e.trigger("change"),a.join(",")}(t,n),e(this).parent().remove(),t.val()?e(a.remove_link).show():e(a.remove_link).hide(),r.stopPropagation()}),l.hover(function(){e(this).parent().toggleClass("grp-autocomplete-preremove")})},l=function(t,r){r.wrapper_search.find("input:first").on("keydown",function(t){t.keyCode===e.ui.keyCode.TAB&&e(this).data("uiAutocomplete").menu.active&&t.preventDefault()}).on("focus",function(){r.wrapper_autocomplete.addClass("grp-state-focus")}).on("blur",function(){r.wrapper_autocomplete.removeClass("grp-state-focus")}).autocomplete({minLength:1,autoFocus:!0,delay:1e3,position:{my:"left top",at:"left bottom",of:r.wrapper_autocomplete},open:function(t,a){e(".ui-menu").width(r.wrapper_autocomplete.outerWidth()-6)},source:function(a,n){e.ajax({url:r.autocomplete_lookup_url,dataType:"json",data:"term="+encodeURIComponent(a.term)+"&app_label="+grappelli.get_app_label(t)+"&model_name="+grappelli.get_model_name(t)+"&query_string="+grappelli.get_query_string(t),beforeSend:function(e){r.loader.show()},success:function(t){n(e.map(t,function(e){return{label:e.label,value:e.value}}))},complete:function(e,t){r.loader.hide()}})},focus:function(){return!1},select:function(a,l){return n(t,l.item.label,r),function(e,t,r){var a=[];e.val()&&(a=e.val().split(",")),a.push(t),e.val(a.join(",")),e.trigger("change"),a.join(",")}(t,l.item.value),t.val()?e(r.remove_link).show():e(r.remove_link).hide(),e(this).val("").trigger("focus"),!1}}).data("ui-autocomplete")._renderItem=function(t,r){return r.value?e("<li></li>").data("item.autocomplete",r).append(e("<a></a>").text(r.label)).appendTo(t):e("<li class='ui-state-disabled'></li>").data("item.autocomplete",r).append(e("<span class='error'></span>").text(r.label)).appendTo(t)}},i=function(t,r){e.getJSON(r.lookup_url,{object_id:t.val(),app_label:grappelli.get_app_label(t),model_name:grappelli.get_model_name(t)},function(a){r.wrapper_repr.find("li.grp-repr").remove(),r.wrapper_search.find("input").val(""),e.each(a,function(e){a[e].value&&n(t,a[e].label,r)}),t.val()?e(r.remove_link).show():e(r.remove_link).hide()})}}(grp.jQuery),function(e){e.fn.grp_collapsible_group=function(r){return r=e.extend({open_handler_slctr:".grp-open-handler",close_handler_slctr:".grp-close-handler",collapsible_container_slctr:".grp-collapse",closed_css:"grp-closed",open_css:"grp-open",on_init:function(){},on_open:function(){},on_close:function(){}},r),this.each(function(){t(e(this),r)})};var t=function(e,t){t.on_init(e,t),r(e,t)},r=function(e,t){a(e,t),n(e,t)},a=function(t,r){t.find(r.open_handler_slctr).each(function(){e(this).on("click",function(){r.on_open(t,r),t.find(r.collapsible_container_slctr).removeClass(r.closed_css).addClass(r.open_css),t.removeClass(r.closed_css).addClass(r.open_css)})})},n=function(t,r){t.find(r.close_handler_slctr).each(function(){e(this).on("click",function(){r.on_close(t,r),t.find(r.collapsible_container_slctr).removeClass(r.open_css).addClass(r.closed_css)})})}}(grp.jQuery),function(e){e.fn.grp_collapsible=function(r){var a=e.extend({toggle_handler_slctr:".grp-collapse-handler:first",closed_css:"grp-closed",open_css:"grp-open",on_init:function(){},on_toggle:function(){}},r);return this.each(function(){t(e(this),a)})};var t=function(e,t){t.on_init(e,t),r(e,t)},r=function(e,t){a(e,t)},a=function(e,t){e.children(t.toggle_handler_slctr).on("click",function(){e.toggleClass(t.closed_css).toggleClass(t.open_css),t.on_toggle(e,t)})}}(grp.jQuery),function(e){e.fn.grp_inline=function(t){return t=e.extend({prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"grp-add-handler",removeCssClass:"grp-remove-handler",deleteCssClass:"grp-delete-handler",emptyCssClass:"grp-empty-form",formCssClass:"grp-dynamic-form",predeleteCssClass:"grp-predelete",onBeforeInit:function(e){},onBeforeAdded:function(e){},onBeforeRemoved:function(e){},onBeforeDeleted:function(e){},onAfterInit:function(e){},onAfterAdded:function(e){},onAfterRemoved:function(e){},onAfterDeleted:function(e){}},t),this.each(function(){var r=e(this);r.find("#id_"+t.prefix+"-TOTAL_FORMS").attr("autocomplete","off"),initInlineForms(r,t),initAddButtons(r,t),addButtonHandler(r.find("a."+t.addCssClass),t),removeButtonHandler(r.find("a."+t.removeCssClass),t),deleteButtonHandler(r.find("a."+t.deleteCssClass),t)})},getFormIndex=function(e,t,r){var a=e.find("[id^='id_"+t.prefix+"']").attr("id");return a?parseInt(r.exec(a)[1],10):-1},updateFormIndex=function(t,r,a,n){t.find(":input,span,table,iframe,label,a,ul,p,img,div").each(function(){var t=e(this),r=t.attr("id"),l=t.attr("name"),i=t.attr("for"),o=t.attr("href"),p=t.attr("class"),s=t.attr("onclick");r&&t.attr("id",r.replace(a,n)),l&&t.attr("name",l.replace(a,n)),i&&t.attr("for",i.replace(a,n)),o&&t.attr("href",o.replace(a,n)),p&&t.attr("class",p.replace(a,n)),s&&t.attr("onclick",s.replace(a,n))}),t.find(".prepopulated_field").each(function(){var t=e(this).data("dependency_ids")||[],r=[];e.each(t,function(e,t){r.push(t.replace(a,n))}),e(this).data("dependency_ids",r)})};initInlineForms=function(t,r){t.find("div.grp-module").each(function(){var t=e(this);r.onBeforeInit(t),""!==t.attr("id")&&t.not("."+r.emptyCssClass).not(".grp-table").not(".grp-thead").not(".add-item").addClass(r.formCssClass),t.find("li.grp-delete-handler-container input").each(function(){e(this).is(":checked")&&t.hasClass("has_original")&&t.toggleClass(r.predeleteCssClass)}),r.onAfterInit(t)})},initAddButtons=function(e,t){var r=e.find("#id_"+t.prefix+"-TOTAL_FORMS"),a=e.find("#id_"+t.prefix+"-MAX_NUM_FORMS");e.find("a."+t.addCssClass);""!==a.val()&&a.val()-r.val()<=0&&hideAddButtons(e,t)},addButtonHandler=function(t,r){t.on("click",function(){var a=t.parents(".grp-group"),n=a.find("#id_"+r.prefix+"-TOTAL_FORMS"),l=a.find("#id_"+r.prefix+"-MAX_NUM_FORMS"),i=(a.find("a."+r.addCssClass),a.find("#"+r.prefix+"-empty"));r.onBeforeAdded(a);var o=parseInt(n.val(),10),p=i.clone(!0);p.removeClass(r.emptyCssClass).attr("id",i.attr("id").replace("-empty",o));updateFormIndex(p,r,/__prefix__/g,o),p.insertBefore(i).addClass(r.formCssClass),n.val(o+1),0!==l.val()&&""!==l.val()&&l.val()-n.val()<=0&&hideAddButtons(a,r),function(t,r){t.find(".prepopulated_field").each(function(){var t=e(this).data("dependency_ids")||[];e(this).prepopulate(t,e(this).attr("maxlength"))})}(p),r.onAfterAdded(p)})},removeButtonHandler=function(t,r){t.on("click",function(){var a=t.parents(".grp-group"),n=e(this).parents("."+r.formCssClass).first(),l=a.find("#id_"+r.prefix+"-TOTAL_FORMS"),i=a.find("#id_"+r.prefix+"-MAX_NUM_FORMS"),o=/-(\d+)-/,p=getFormIndex(n,r,o);r.onBeforeRemoved(n),n.remove(),l.val(parseInt(l.val(),10)-1),0!==i.val()&&i.val()-l.val()>0&&showAddButtons(a,r),a.find("."+r.formCssClass).each(function(){var t=e(this),a=getFormIndex(t,r,o);a>p&&updateFormIndex(t,r,o,"-"+(a-1)+"-")}),r.onAfterRemoved(a)})},deleteButtonHandler=function(t,r){t.on("click",function(){var t=e(this).prev(),a=e(this).parents("."+r.formCssClass).first();r.onBeforeDeleted(a),a.hasClass("has_original")&&(a.toggleClass(r.predeleteCssClass),t.prop("checked")?t.removeAttr("checked"):t.prop("checked",!0)),r.onAfterDeleted(a)})},hideAddButtons=function(e,t){var r=e.find("a."+t.addCssClass);r.hide().parents(".grp-add-item").hide(),r.closest(".grp-module.grp-transparent").hide()},showAddButtons=function(e,t){var r=e.find("a."+t.addCssClass);r.show().parents(".grp-add-item").show(),r.closest(".grp-module.grp-transparent").show()}}(grp.jQuery),function(e){var t={init:function(t){return t=e.extend({},e.fn.grp_related_fk.defaults,t),this.each(function(){var a=e(this),n=a.parent();n.find("a.related-lookup").next().is("strong")&&(n.find("a.related-lookup").get(0).nextSibling.nodeValue="",n.find("a.related-lookup").next("strong").remove()),n.find("a.related-lookup").after(t.placeholder),a.addClass("grp-has-related-lookup"),r(a,t),a.on("change focus keyup",function(){r(a,t)})})}};e.fn.grp_related_fk=function(r){return t[r]?t[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?(e.error("Method "+r+" does not exist on jQuery.grp_related_fk"),!1):t.init.apply(this,arguments)};var r=function(t,r){var a=t.parent().find(".grp-placeholder-related-fk");e.getJSON(r.lookup_url,{object_id:t.val(),app_label:grappelli.get_app_label(t),model_name:grappelli.get_model_name(t),query_string:grappelli.get_query_string(t),to_field:grappelli.get_to_field(t)},function(t){""===t[0].label?a.hide():a.show(),t[0].safe?a.html(e('<span class="grp-placeholder-label"></span>').html(t[0].label+"‎")):a.html(e('<span class="grp-placeholder-label"></span>').text(t[0].label+"‎"))})};e.fn.grp_related_fk.defaults={placeholder:'<div class="grp-placeholder-related-fk"></div>',repr_max_length:30,lookup_url:""}}(grp.jQuery),function(e){var t={init:function(t){return t=e.extend({},e.fn.grp_related_generic.defaults,t),this.each(function(){var l=e(this),i=e(t.content_type).val()||e(t.content_type).find(":checked").val();i&&l.after(t.placeholder).after(r(l.attr("id"),i)),l.addClass("grp-has-related-lookup"),i&&n(l,t),l.on("change focus keyup",function(){n(l,t)}),e(t.content_type).on("change",function(){a(e(this),t)})})}};e.fn.grp_related_generic=function(r){return t[r]?t[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?(e.error("Method "+r+" does not exist on jQuery.grp_related_generic"),!1):t.init.apply(this,arguments)};var r=function(t,r){var a=e('<a class="related-lookup"></a>');return a.attr("id","lookup_"+t),a.attr("href",window.ADMIN_URL+MODEL_URL_ARRAY[r].app+"/"+MODEL_URL_ARRAY[r].model+"/?"),a.attr("onClick","return showRelatedObjectLookupPopup(this);"),a},a=function(t,a){var n=e(a.object_id);n.val(""),n.parent().find("a.related-lookup").remove(),n.parent().find(".grp-placeholder-related-generic").remove();var l=e(t).val()||e(t).find(":checked").val();l&&n.after(a.placeholder).after(r(n.attr("id"),l))},n=function(t,r){var a=t.next().next();e.getJSON(r.lookup_url,{object_id:t.val(),app_label:grappelli.get_app_label(t),model_name:grappelli.get_model_name(t),query_string:grappelli.get_query_string(t)},function(t){""===t[0].label?a.hide():a.show(),t[0].safe?a.html(e('<span class="grp-placeholder-label"></span>').html(t[0].label+"‎")):a.html(e('<span class="grp-placeholder-label"></span>').text(t[0].label+"‎"))})};e.fn.grp_related_generic.defaults={placeholder:'<div class="grp-placeholder-related-generic" style="display:none"></div>',repr_max_length:30,lookup_url:"",content_type:"",object_id:""}}(grp.jQuery),function(e){var t={init:function(t){return t=e.extend({},e.fn.grp_related_m2m.defaults,t),this.each(function(){var a=e(this);a.parent().find("a.related-lookup").after(t.placeholder),a.next().addClass("grp-m2m"),a.addClass("grp-has-related-lookup"),r(a,t),a.on("change focus keyup",function(){r(a,t)})})}};e.fn.grp_related_m2m=function(r){return t[r]?t[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?(e.error("Method "+r+" does not exist on jQuery.grp_related_m2m"),!1):t.init.apply(this,arguments)};var r=function(t,r){e.getJSON(r.lookup_url,{object_id:t.val(),app_label:grappelli.get_app_label(t),model_name:grappelli.get_model_name(t),query_string:grappelli.get_query_string(t)},function(r){values=e.map(r,function(t,a){return r.length!==a+1||t.safe?r.length===a+1&&t.safe?e('<span class="grp-placeholder-label"></span>').html(t.label+"‎"):t.safe?e('<span class="grp-placeholder-label"></span>').html(t.label+"‎").append(e('<span class="grp-separator"></span>')):e('<span class="grp-placeholder-label"></span>').text(t.label+"‎").append(e('<span class="grp-separator"></span>')):e('<span class="grp-placeholder-label"></span>').text(t.label+"‎")}),""===values?t.parent().find(".grp-placeholder-related-m2m").hide():t.parent().find(".grp-placeholder-related-m2m").show(),t.parent().find(".grp-placeholder-related-m2m").html(values)})};e.fn.grp_related_m2m.defaults={placeholder:'<div class="grp-placeholder-related-m2m"></div>',repr_max_length:30,lookup_url:""}}(grp.jQuery),function(e){e.widget("ui.grp_timepicker",{options:{template:'<div id="ui-timepicker" class="module" style="position: absolute; display: none;"></div>',timepicker_selector:"#ui-timepicker",offset:{top:0},default_time_list:["now","00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],time_list:[]},_create:function(){var t=this;e(document).on("mousedown",function(r){if(t.timepicker.is(":visible")){var a=e(r.target);a[0].id==t.timepicker[0].id||0!==a.parents(t.options.timepicker_selector).length||a.hasClass("hasTimepicker")||a.hasClass("ui-timepicker-trigger")||t.timepicker.hide()}}),e(document).on("keyup",function(e){27==e.keyCode&&t.timepicker.hide()}),0===e(this.options.timepicker_selector).length&&e(this.options.template).appendTo("body"),this.timepicker=e(this.options.timepicker_selector),this.timepicker.hide(),this.element.addClass("hasTimepicker"),this.button=e('<button type="button" class="ui-timepicker-trigger"></button>'),this.element.after(this.button),this.element.prop("disabled")?this.button.prop("disabled",!0):this.button.on("click",function(){t._toggleTimepicker()})},_toggleTimepicker:function(){this.timepicker.is(":visible")?this.timepicker.hide():(this.element.trigger("focus"),this._generateTimepickerContents(),this._showTimepicker())},_generateTimepickerContents:function(){var t=this,r="<ul>";0===this.options.time_list.length&&(this.options.time_list=this.options.default_time_list);for(var a=0;a<this.options.time_list.length;a++)if("now"==this.options.time_list[a]){var n=new Date,l=n.getHours(),i=n.getMinutes();r+='<li class="ui-state-active row">'+(l=l<10?"0"+l:l)+":"+(i=i<10?"0"+i:i)+"</li>"}else r+='<li class="ui-state-default row">'+this.options.time_list[a]+"</li>";r+="</ul>",this.timepicker.html(r),this.timepicker.find("li").on("click",function(){e(this).parent().children("li").removeClass("ui-state-active"),e(this).addClass("ui-state-active"),t.element.val(e(this).html()),t.timepicker.hide()})},_showTimepicker:function(){var e=document.documentElement.clientHeight,t=document.documentElement.scrollTop||document.body.scrollTop,r=this.element.outerHeight(),a=this.timepicker.outerHeight()+r,n=this.element.offset().top,l=this.element.offset().left;if(n-t+a+60<e){var i=n+r;this.timepicker.css("left",l+"px").css("top",i+"px")}else{var o=n-a+r;this.timepicker.css("left",l+"px").css("top",o+"px")}this.timepicker.show()},destroy:function(){e.Widget.prototype.destroy.apply(this,arguments)}})}(grp.jQuery);